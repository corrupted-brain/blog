---
layout: post
title:  "Exploiting thousands of Domains for XSS"
excerpt: Exploiting goDaddy service to affect thousands of domains with cross site scripting vulnerability.
tags: [XSS, GoDaddy XSS, Reverse CNAME,]
---

This blog post is about Cross Site Scripting (XSS) vulnerability found in secure page of GoDaddy. 

While pen testing in wide scope for a client I found a subdomain as files.example.com. Opening in browser results as shown below

![](/images/posts/godaddy/1.png)

After that, I ran a Burp Suite auto scan over it, and the reflector (a Burps Suite extension) showed that some inputs got reflected in the response.

![](/images/posts/godaddy/2.png)

Now it's time to find a vulnerability for script injection. After analyzing the suspicious parameter, I found the possible way for the execution of JavaScript code and was finally able to execute it as shown below. The vulnerable URL looks like: *http://files.example.com/index.php/"onmouseleave="alert('XSS')"*

![](/images/posts/godaddy/3.png)

But wait, what is the use of this webpage, and who added this subdomain? Checking the CNAME of this subdomain, I found that it belongs to Godaddy. 

![](/images/posts/godaddy/4.png)

As a service provider, Godaddy must have thousands of clients using this service (probably the file-sharing feature), and all of them are vulnerable to the Cross Site Scripting (XSS) vulnerability. To verify this, I thought of using simple Google Dork to find similar webpages.

![](/images/posts/godaddy/5.jpg)

However, this is not the appropriate way, hence I discussed with @smaranchand for possible ways of gathering all the subdomains on the internet that are using [files.secureserver.net](http://files.secureserver.net/)
 as CNAME in their DNS records. He came up with the idea of using [Silent Push](https://explore.silentpush.com/explore-result?name=files.secureserver.net&queryType=answer&type=CNAME). We used reverse CNAME lookup to find affected domains for the XSS vulnerability and found that around 13,092 domains were vulnerable. This is a very large number of vulnerable systems that we can impact with a vulnerability.

![](/images/posts/godaddy/6.png)

After confirming the vulnerability on a few subdomains, I decided to notify GoDaddy security and email them a detailed proof of concept using thier email security@godaddy.com. However, they didnâ€™t respond until. To my surprise, the vulnerability has been patched by them. After a few searches, I also came to know that the same vulnerability had previously been reported by [turbobarsuchiha](https://medium.com/@turbobarsuchiha?source=post_page-----5828c3e2040c--------------------------------). She also did not receive any reasonable response from GoDaddy and decided to post on her blog.

**Lesson Learned:**

- Always monitor third party DNS entries and hosted applications for possible threats and vulnerabilities.
- Never exclude static pages for security testing.
- Examine each issue generated by Burp Suite manually.